<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>AlazarTech oscilloscope plugin &#8212; PLACE 0.10.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/pydoctheme.css" />
    
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    
    <script src="_static/sidebar.js"></script>
    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Custom Script Module" href="custom_script_1.html" />
    <link rel="prev" title="Export module base class" href="export.html" />
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <link rel="shortcut icon" type="image/png" href="_static/favicon.png" />
    <meta name="viewport" content="width=device-width,initial-scale=0.8">
    
    

  </head><body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="responsive-menu"><a href="#sidebar-anchor" title="Navigation">&#9776;</a></li>
        <li><a href="index.html">PLACE 0.10.0 documentation</a> &#187;</li> 
      </ul>
    </div>
    
        <div class="badge">
            <a href="https://github.com/PALab/place/">Fork me on GitHub</a>
            <img src="_static/right-red@2x.png">
        </div>
    
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="module-place.plugins.alazartech.alazartech">
<span id="alazartech-oscilloscope-plugin"></span><h1>AlazarTech oscilloscope plugin<a class="headerlink" href="#module-place.plugins.alazartech.alazartech" title="Permalink to this heading">¶</a></h1>
<p>PLACE plugin for the AlazarTech ATS660 and ATS9440 oscilloscope cards.</p>
<p>Oscilloscopes are at the heart of many data acquisition experiments and contain
many configuration options. At the time of this writing, this PLACE module is by
far the most complex. However, even though it is complex, it still follows the
basic PLACE philosophy of config/update/cleanup.</p>
<p>This plugin can be used as an example for how to program complex instruments
into the PLACE system.</p>
<dl class="py class">
<dt class="sig sig-object py" id="place.plugins.alazartech.alazartech.ATSGeneric">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">place.plugins.alazartech.alazartech.</span></span><span class="sig-name descname"><span class="pre">ATSGeneric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plotter</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/place/plugins/alazartech/alazartech.html#ATSGeneric"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#place.plugins.alazartech.alazartech.ATSGeneric" title="Permalink to this definition">¶</a></dt>
<dd><p>Generic AlazarTech oscillscope card.</p>
<p>All AlazarTech cards use the same underlying driver. This class provides
access to these universal features. This class should be overridden if
classes are needed for specific cards.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This class currently only supports boards providing data in an
unsigned, 2 bytes per sample, format. It should support 12, 14, and
16-bits per sample.  If 8-bits per sample is desired, functionality
will need to be added to this class.</p>
</div>
<p>AlazarTech requires the following configuration data (accessible as
self._config[’<em>key</em>’]):</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Key</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>clock_source</p></td>
<td><p>string</p></td>
<td><p>the timing clock to use
(must name a constant from the ATS driver file)</p></td>
</tr>
<tr class="row-odd"><td><p>clock_edge</p></td>
<td><p>string</p></td>
<td><p>the edge of the clock signal to use
(must name a constant from the ATS driver file)</p></td>
</tr>
<tr class="row-even"><td><p>trigger_operation</p></td>
<td><p>string</p></td>
<td><p>how the trigger engine signals are joined
(must name a constant from the ATS driver file)</p></td>
</tr>
<tr class="row-odd"><td><p>trigger_engine_1</p></td>
<td><p>string</p></td>
<td><p>the first trigger engine to use
(must name a constant from the ATS driver file)</p></td>
</tr>
<tr class="row-even"><td><p>trigger_source_1</p></td>
<td><p>string</p></td>
<td><p>the source of the first trigger
(must name a constant from the ATS driver file)</p></td>
</tr>
<tr class="row-odd"><td><p>trigger_slope_1</p></td>
<td><p>string</p></td>
<td><p>the signal slope that the first trigger
responds to</p></td>
</tr>
<tr class="row-even"><td><p>trigger_level_1</p></td>
<td><p>int</p></td>
<td><p>the signal level of the first trigger, where
<code class="docutils literal notranslate"><span class="pre">128</span></code> is near 0 volts, <code class="docutils literal notranslate"><span class="pre">0</span></code> is the minimun
input range, and <code class="docutils literal notranslate"><span class="pre">255</span></code> is the maximum input
range
(must name a constant from the ATS driver file)</p></td>
</tr>
<tr class="row-odd"><td><p>trigger_engine_2</p></td>
<td><p>string</p></td>
<td><p>the second trigger engine to use
(must name a constant from the ATS driver file)</p></td>
</tr>
<tr class="row-even"><td><p>trigger_source_2</p></td>
<td><p>string</p></td>
<td><p>the source of the second trigger
(must name a constant from the ATS driver file)</p></td>
</tr>
<tr class="row-odd"><td><p>trigger_slope_2</p></td>
<td><p>string</p></td>
<td><p>the signal slope that the second trigger
responds to
(must name a constant from the ATS driver file)</p></td>
</tr>
<tr class="row-even"><td><p>trigger_level_2</p></td>
<td><p>int</p></td>
<td><p>the signal level of the second trigger, where
<code class="docutils literal notranslate"><span class="pre">128</span></code> is near 0 volts, <code class="docutils literal notranslate"><span class="pre">0</span></code> is the minimun
input range, and <code class="docutils literal notranslate"><span class="pre">255</span></code> is the maximum input
range</p></td>
</tr>
<tr class="row-odd"><td><p>pre_trigger_samples</p></td>
<td><p>int</p></td>
<td><p>number of samples to return prior to the trigger</p></td>
</tr>
<tr class="row-even"><td><p>post_trigger_samples</p></td>
<td><p>int</p></td>
<td><p>number of samples to return after the trigger</p></td>
</tr>
<tr class="row-odd"><td><p>records</p></td>
<td><p>int</p></td>
<td><p>the number of records to acquire (per update)</p></td>
</tr>
<tr class="row-even"><td><p>average</p></td>
<td><p>bool</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">True</span></code> if records should be averaged into one</p></td>
</tr>
<tr class="row-odd"><td><p>sample_rate</p></td>
<td><p>string</p></td>
<td><p>the sample rate to be used on the card
(must name a constant from the ATS driver file)</p></td>
</tr>
<tr class="row-even"><td><p>decimation</p></td>
<td><p>int</p></td>
<td><p>a decimation factor for the signal</p></td>
</tr>
<tr class="row-odd"><td><p>plot</p></td>
<td><p>string</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">'yes'</span></code> if plotting should occur</p></td>
</tr>
<tr class="row-even"><td><p>analog_inputs</p></td>
<td><p>list</p></td>
<td><p>configuration data for the input channels
(see the <code class="docutils literal notranslate"><span class="pre">AnalogInput</span></code> class for more info)</p></td>
</tr>
</tbody>
</table>
<p>AlazarTech will produce the following experimental metadata:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Key</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>bits_per_sample</p></td>
<td><p>int</p></td>
<td><p>the bits resolution of samples taken</p></td>
</tr>
<tr class="row-odd"><td><p>samples_per_record</p></td>
<td><p>int</p></td>
<td><p>the number of samples in each record saved by
PLACE</p></td>
</tr>
<tr class="row-even"><td><p>sampling_rate</p></td>
<td><p>int</p></td>
<td><p>the integer calculation of the sampling rate
(in samples/second)</p></td>
</tr>
</tbody>
</table>
<p>AlazarTech will produce the following experimental data:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Heading</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>trace</p></td>
<td><p>(channel,record,sample)
array of uint16</p></td>
<td><p>the trace data recorded
on the oscilloscope</p></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We will add the instrument class name to the heading. For example,
<code class="docutils literal notranslate"><span class="pre">trace</span></code> will be recorded as <code class="docutils literal notranslate"><span class="pre">ATS9440-trace</span></code> when using the
ATS9440 oscilloscope card. The reason for this is because NumPy will
not check for duplicate heading names, so prepending the class name
greatly reduces the likelihood of data loss.</p>
</div>
<p>Example code for reading AlazarTech data from a PLACE .npy file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;scan_data.npy&#39;</span><span class="p">)</span>
<span class="n">heading</span> <span class="o">=</span> <span class="s1">&#39;ATS660-trace&#39;</span>
<span class="n">row</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># corresponds to the &#39;update&#39; number</span>
<span class="n">alazartech_data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">heading</span><span class="p">][</span><span class="n">row</span><span class="p">]</span>
<span class="n">channel</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">record</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">sample</span> <span class="o">=</span> <span class="mi">9</span>
<span class="n">sample10</span> <span class="o">=</span> <span class="n">alazartech_data</span><span class="p">[</span><span class="n">channel</span><span class="p">][</span><span class="n">record</span><span class="p">][</span><span class="n">sample</span><span class="p">]</span>
</pre></div>
</div>
<p>In this example, we are looking at the data in a file named
<code class="docutils literal notranslate"><span class="pre">data_000.npy</span></code>. This file is created after the first update in a
PLACE experiment and contains one row of data. The AlazarTech data is
therefore located in the column named <code class="docutils literal notranslate"><span class="pre">'ATS660-trace'</span></code> and row <code class="docutils literal notranslate"><span class="pre">0</span></code>.
From there, we can examine the data as desired.</p>
<p>If the experiment has completed normally, all the rows will be stored in a
single file, named <code class="docutils literal notranslate"><span class="pre">data.npy</span></code>. In this case, the code above is the same,
but you would need to specify the row value desired.</p>
<dl class="py method">
<dt class="sig sig-object py" id="place.plugins.alazartech.alazartech.ATSGeneric.config">
<span class="sig-name descname"><span class="pre">config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metadata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">total_updates</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/place/plugins/alazartech/alazartech.html#ATSGeneric.config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#place.plugins.alazartech.alazartech.ATSGeneric.config" title="Permalink to this definition">¶</a></dt>
<dd><p>Configure the AlazarTech oscilliscope card.</p>
<p>This method is responsible for reading configuration date from
<code class="docutils literal notranslate"><span class="pre">self._config</span></code> and using this data to configure the oscilloscope card
for data acquisition. We mirror the steps suggested by the SDK Guide:</p>
<blockquote class="epigraph">
<div><p>“<em>Before acquiring data from a board system, an application must
configure the timebase, analog inputs, and trigger system settings
for each board in the board system.</em>”</p>
<p class="attribution">—ATS SDK Guide</p>
</div></blockquote>
<p>After configuring the board, this method also performs the first data
acquisition steps by setting the record size and the record count.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>metadata</strong> (<em>dict</em>) – PLACE maintains metadata for each experiment in a
dictionary object. During the configuration phase,
this dictionary is passed to each instrument through
this function so that relevant instrument data can be
recorded into it. Instruments should record
information that is relevant to the entire experiment,
but is also specific to the instrument. For example,
if an instrument is using one of many filters during
this experiment, it would be appropriate to record the
filter into the experiment metadata.</p></li>
<li><p><strong>total_updates</strong> (<em>int</em>) – This value will always be used to inform each
instrument of the number of updates (or steps)
that will be perfomed during this experiment.
Instruments should use this value to determine
when to perform specific tasks during the
experiment.  For example, some instruments may
want to perform a task at the midpoint of an
experiment and can therefore use this value to
determine which update will represent the
midpoint.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="place.plugins.alazartech.alazartech.ATSGeneric.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">update_number</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">progress</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/place/plugins/alazartech/alazartech.html#ATSGeneric.update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#place.plugins.alazartech.alazartech.ATSGeneric.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Record a trace using the current configuration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>update_number</strong> (<em>int</em>) – This will be the current update number (starting
with 0) of the experiment. Instruments could
certainly count the number of updates themselves,
but this is provided as a convenience.</p></li>
<li><p><strong>progress</strong> (<em>dict</em>) – A blank dictionary for sending data back to the frontend</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a multi-dimensional array containing the channel, record, and
sample data.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.array dtype=’(<em>number_channels</em>, <em>number_records</em>,
<em>number_samples</em>)uint16’</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="place.plugins.alazartech.alazartech.ATSGeneric.cleanup">
<span class="sig-name descname"><span class="pre">cleanup</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">abort</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/place/plugins/alazartech/alazartech.html#ATSGeneric.cleanup"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#place.plugins.alazartech.alazartech.ATSGeneric.cleanup" title="Permalink to this definition">¶</a></dt>
<dd><p>Nothing to cleanup</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>abort</strong> (<em>bool</em>) – indicates the experiment has been stopped rather than
having finished normally</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="place.plugins.alazartech.alazartech.AnalogInput">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">place.plugins.alazartech.alazartech.</span></span><span class="sig-name descname"><span class="pre">AnalogInput</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">channel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coupling</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_range</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">impedance</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/place/plugins/alazartech/alazartech.html#AnalogInput"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#place.plugins.alazartech.alazartech.AnalogInput" title="Permalink to this definition">¶</a></dt>
<dd><p>Class describing a specific input (channel) on the AlazarTech card.</p>
<p>Each AlazarTech card can have many input channels. Instead of maintaining
configuration data for all inputs, we dynamically create configuration
objects containing the data for just one input. This data is provided as a
list of configurations in the AlazarTech configuration data.</p>
<p>AnalogInput requires the following configuration data (found in
<code class="docutils literal notranslate"><span class="pre">self._config['analog_inputs']</span></code> and passed to the constructor):</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Key</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>input_channel</p></td>
<td><p>string</p></td>
<td><p>the channel associated with this input
(must name a constant from the ATS driver file)</p></td>
</tr>
<tr class="row-odd"><td><p>input_coupling</p></td>
<td><p>string</p></td>
<td><p>AC or DC coupling
(must name a constant from the ATS driver file)</p></td>
</tr>
<tr class="row-even"><td><p>input_range</p></td>
<td><p>string</p></td>
<td><p>the voltage input range
(must name a constant from the ATS driver file)</p></td>
</tr>
<tr class="row-odd"><td><p>input_impedance</p></td>
<td><p>string</p></td>
<td><p>the selected impedance for the input
(must name a constant from the ATS driver file)</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="place.plugins.alazartech.alazartech.ATS660">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">place.plugins.alazartech.alazartech.</span></span><span class="sig-name descname"><span class="pre">ATS660</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plotter</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/place/plugins/alazartech/alazartech.html#ATS660"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#place.plugins.alazartech.alazartech.ATS660" title="Permalink to this definition">¶</a></dt>
<dd><p>Subclass for ATS660</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="place.plugins.alazartech.alazartech.ATS9440">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">place.plugins.alazartech.alazartech.</span></span><span class="sig-name descname"><span class="pre">ATS9440</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plotter</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/place/plugins/alazartech/alazartech.html#ATS9440"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#place.plugins.alazartech.alazartech.ATS9440" title="Permalink to this definition">¶</a></dt>
<dd><p>Subclass for ATS9440</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="place.plugins.alazartech.alazartech.ATS9462">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">place.plugins.alazartech.alazartech.</span></span><span class="sig-name descname"><span class="pre">ATS9462</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plotter</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/place/plugins/alazartech/alazartech.html#ATS9462"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#place.plugins.alazartech.alazartech.ATS9462" title="Permalink to this definition">¶</a></dt>
<dd><p>Subclass for ATS9462</p>
</dd></dl>

</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
    <a id="sidebar-anchor"></a>
    

  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="export.html"
                          title="previous chapter">Export module base class</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="custom_script_1.html"
                          title="next chapter">Custom Script Module</a></p>
  </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
<div id="sidebarbutton" title="Collapse sidebar">
<span>«</span>
</div>

      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="custom_script_1.html" title="Custom Script Module"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="export.html" title="Export module base class"
             accesskey="P">previous</a> |</li>
      </ul>
    </div>

    <div class="footer" role="contentinfo">
        &#169; Copyright 2018, Paul Freeman, Jami L. Johnson, Henrik tom Wörden, and Kasper van Wijk.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 5.0.2.
    </div>
  </body>
</html>